YUI.add("moodle-atto_morefontcolors-button",function(n,o){n.namespace("M.atto_morefontcolors").Button=n.Base.create("button",n.M.editor_atto.EditorPlugin,[],{_currentSelection:null,_content:null,initializer:function(o){var i=[],t=this.get("colors");n.Array.each(t,function(o){var t,e,n;if(o.trim())for(t=o.split(/\s+/),e=0;e<t.length;e++)n=t[e].trim(),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(n)&&i.push({text:'<div style="width: 20px; height: 20px; border: 1px solid #CCC; background-color: '+n+'"></div>',callbackArgs:n,callback:this._changeStyle})}),"1"===o.allowcustom&&i.push({text:'<div style="width: 20px; height: 20px; border: 1px solid #CCC;" id="atto_morefontcolors_customicon"></div>',callback:this._customColor}),this.addToolbarMenu({icon:"e/text_color",overlayWidth:"4",menuColor:"#333333",globalItemConfig:{inlineFormat:!0,callback:this._changeStyle},items:i})},_changeStyle:function(o,t){this.get("host").formatSelectionInlineStyle({color:t})},_customColor:function(){var o=n.Handlebars.compile('<form id="atto_morefontcolors_dialogue"><div class="picker"><div id="atto_morefontcolors_dialogue_hue-dial"></div><div class="sliders"><div id="atto_morefontcolors_dialogue_sat-slider"><strong>{{get_string "saturation" component}}<span></span></strong></div><div id="atto_morefontcolors_dialogue_lum-slider"><strong>{{get_string "luminance" component}}<span></span></strong></div></div><div class="color"></div></div><div class="yui3-g picker-output"><div class="yui3-u-1-3"><strong>{{get_string "hexadecimal" component}}</strong><input type="text" id="atto_morefontcolors_dialogue_hex-output"></div><div class="yui3-u-1-3"><strong>{{get_string "rgb" component}}</strong><input type="text" id="atto_morefontcolors_dialogue_rgb-output"></div><div class="yui3-u-1-3"><strong>{{get_string "hsl" component}}</strong><input type="text" id="atto_morefontcolors_dialogue_hsl-output"></div></div><div class="mdl-align"><button type="submit" class="submit">{{get_string "submit" component}}</button></div></form>'),e=this.getDialogue({headerContent:M.util.get_string("customcolor","atto_morefontcolors"),width:"470px",focusAfterHide:!0});this._currentSelection=this.get("host").getSelection(),this._content=n.Node.create(o({component:"atto_morefontcolors"})),e.set("bodyContent",this._content).show(),this._initiateColorPicker(),this._content.one(".submit").on("click",function(o){o.preventDefault(),this.getDialogue({focusAfterHide:null}).hide();var t=n.one("#"+e.get("id")+" #atto_morefontcolors_dialogue_rgb-output").get("value");this.get("host").setSelection(this._currentSelection),this._changeStyle(o,t)},this)},_initiateColorPicker:function(){var i="#"+this.getDialogue().get("id")+" #atto_morefontcolors_dialogue";YUI().use("dial","slider","event-valuechange","color",function(r){r.one(i+" .picker").addClass("yui3-skin-sam");var a=new r.Dial({min:0,max:360,stepsPerRevolution:360,continuous:!0,centerButtonDiameter:.4,render:i+" #atto_morefontcolors_dialogue_hue-dial"}),s=new r.Slider({min:0,max:100,value:100,render:i+" #atto_morefontcolors_dialogue_sat-slider"}),u=new r.Slider({min:0,max:100,value:50,render:i+" #atto_morefontcolors_dialogue_lum-slider"}),c=r.one(i+" #atto_morefontcolors_dialogue_sat-slider span"),d=r.one(i+" #atto_morefontcolors_dialogue_lum-slider span"),g=r.one(i+" .color"),_=r.one(i+" #atto_morefontcolors_dialogue_hex-output"),m=r.one(i+" #atto_morefontcolors_dialogue_rgb-output"),f=r.one(i+" #atto_morefontcolors_dialogue_hsl-output"),v=null,o=function(o){v=o.currentTarget},t=function(o){v===o.currentTarget&&(v=null)},e=function(o){var t,e=o.newVal,n=[];r.Color.toArray(e)&&(n=r.Color.toArray(r.Color.toHSL(e)),"undefined"!=typeof(t={h:n[0],s:n[1],l:n[2]}).h&&a.set("value",+t.h),"undefined"!=typeof t.s&&s.set("value",+t.s),"undefined"!=typeof t.l&&u.set("value",+t.l))},n=function(){var o,t=a.get("value"),e=s.get("value"),n=u.get("value"),i=r.Color.fromArray([t,e,n],r.Color.TYPES.HSL),l=r.Color.toHex(i);c.set("text",e+"%"),d.set("text",n+"%"),g.setStyle("backgroundColor",l),o=i,_!==v&&_.set("value",r.Color.toHex(o)),m!==v&&m.set("value",r.Color.toRGB(o)),f!==v&&f.set("value",o)};_.on("focus",o),_.on("blur",t),_.on("valueChange",e),m.on("focus",o),m.on("blur",t),m.on("valueChange",e),f.on("focus",o),f.on("blur",t),f.on("valueChange",e),a.after("valueChange",function(){n()}),s.after("thumbMove",function(){n()}),u.after("thumbMove",function(){d.set("text",u.get("value")+"%"),n()}),n()})}},{ATTRS:{colors:{value:{}}}},{ATTRS:{colors:{value:{}}}})},"@VERSION@");